import angr
import IPython

stdin = "STDIN"
arg = "ARG"
libpwnable = "LIBPWNABLE"


def checkInputType(binary_name):

	p = angr.Project(binary_name)
	if any(["libpwnable" in str(x.binary) for x in p.loader.all_elf_objects]):
		return libpwnable
	p = angr.Project(binary_name,  load_options={"auto_load_libs": False})

	reading_functions = ["fgets", "gets", "scanf", "read", "__isoc99_scanf"]

	binary_functions = list(p.loader.main_object.imports.keys())

	if any([x in reading_functions for x in binary_functions]):
		# print(binary_functions)
		return "STDIN"
	return "ARG"